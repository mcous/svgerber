!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a){var b,c,d,e,f,g,h,i,j,k,l,m;e=a("gerber-to-svg"),j=function(){var a;return $("#filelist").children().not("#js-upload-template").remove(),$("#upload-list").addClass("hidden"),$("a.nav-link").parent().removeClass("active").addClass("disabled"),$("#nav-upload").removeClass("disabled").addClass("active"),a=$("#individual-layer-output"),a.find("div.layer-drawing").data("full",!1),a.find("svg").remove(),a.find("a.layer-link").attr("href","#"),a.addClass("hidden")},b=function(a){var b;return b=$("#process").text("svGo!"),b.on("click",function(c){var d,e,g;return c.stopPropagation(),c.preventDefault(),b.off("click"),b.attr("disabled","disabled"),b.text("svGoing!"),g=$("#individual-layer-output"),g.removeClass("hidden").css("visibility","hidden"),e=-1,d=function(){return e++,e<a.length?f(a[e],d):(g.css("visibility","visible"),b.text("svGone!"),$("#nav-svgs").removeClass("disabled"),$("html, body").animate({scrollTop:$("#individual-layer-output").offset().top-$("#top-nav").height()-10},250))},setTimeout(d,50),!1}),$("#nav-layers").removeClass("disabled"),b.removeAttr("disabled"),$("html, body").animate({scrollTop:$("#upload-list").offset().top-$("#top-nav").height()-10},250)},k=function(a,b){var c,d;return d="oth",b.match(/(\.gtl)|(\.cmp)$/i)?d="fcu":b.match(/(\.gts)|(\.stc)$/i)?d="fsm":b.match(/(\.gto)|(\.plc)$/i)?d="fss":b.match(/(\.gbl)|(\.sol)$/i)?d="bcu":b.match(/(\.gbs)|(\.sts)$/i)?d="bsm":b.match(/(\.gbo)|(\.pls)$/i)?d="bss":b.match(/(\.gko$)|edge/i)&&(d="out"),c=a.children("[value='"+d+"']").attr("selected","selected"),d},f=function(a,b){var c,d,f,g,h,i,j,k,l,m,n;return d=a.filename,l=$(document.getElementById("js-layer-select-"+d)),g=l.find(":selected").attr("value"),k=document.getElementById("js-plot-progress-"+d),c=0,h=4,"oth"===g?(k.setAttribute("aria-valuenow","100"),k.style.width="100%",void(null!=b&&"function"==typeof b&&b())):(a=a.file,m=null,i=null,f=$(document.getElementById("js-upload-"+d)).children(".mega-octicon"),f.removeClass("octicon-chevron-right"),f.addClass("octicon-pencil"),j=$("#"+g),m=e(a),j.html(m),n="data:image/svg+xml;base64,"+m,j.siblings("a.layer-link").attr("href",n),f.removeClass("octicon-pencil"),f.addClass("octicon-check"),k.setAttribute("aria-valuenow","100"),k.style.width="100%",null!=b&&"function"==typeof b?b():void 0)},l=function(a,b,c){var d,e;return d=a.detail,null!=d.current&&(e=Math.round(d.current/d.total*100),100>=e)?(c["aria-valuenow"]=""+e,c.style.width=""+e+"%"):void 0},h=function(a){var c,d,e,f,g,h;for(a.stopPropagation(),a.preventDefault(),j(),d=null,null!=a.dataTransfer?(d=a.dataTransfer.files,a.dataTransfer.files=null):(d=a.target.files,a.target.files=null),$("#upload-list").removeClass("hidden"),e=[],h=[],f=0,g=d.length;g>f;f++)c=d[f],h.push(function(a){var c,f,g,h,i,j;return j=$("#js-upload-template"),c=j.clone().attr("id","js-upload-"+a.name),g=c.find(".filename"),g.text(""+a.name),f=c.find(".layer-type-select"),f.attr("id","js-layer-select-"+a.name),g=k(f,a.name),h=c.find("#js-plot-progress-template"),h.attr("id","js-plot-progress-"+a.name),h.attr("aria-valuenow","0").width("0%"),c.removeClass("js-template"),j.after(c),i=new FileReader,i.onloadend=function(c){return c.stopPropagation(),c.preventDefault(),c.target.readyState===FileReader.DONE&&(e.push({filename:a.name,file:c.target.result,name:g}),e.length===d.length)?b(e):void 0},i.readAsText(a)}(c));return h},g=function(a){return a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"},c=document.getElementById("dropzone"),c.addEventListener("dragover",g,!1),c.addEventListener("drop",h,!1),d=document.getElementById("file-upload-select"),d.addEventListener("change",h,!1),i=$("a.nav-link"),$("a.nav-link").on("click",function(a){var b,c,d;return a.stopPropagation(),a.preventDefault(),b=$(this),d=b.parent(),d.hasClass("disabled")?void 0:(c=b.attr("href").split("#")[1],$("html, body").animate({scrollTop:$("#"+c).offset().top-$("#top-nav").height()-10},250))}),$("#title").on("click",function(a){var b;return a.stopPropagation(),a.preventDefault(),b=$(this).children("a"),j(),$("html, body").animate({scrollTop:0},250)}),m=$(window),m.scroll(function(){var a,b;return b=m.scrollTop()+m.height()/2,(a=$("#nav-upload")).hasClass("active")||(a.siblings().removeClass("active"),a.addClass("active")),b>=$("#upload-list").offset().top-$("#top-nav").height()-10&&((a=$("#nav-layers")).hasClass("disabled")||(a.siblings().removeClass("active"),a.addClass("active"))),b>=$("#individual-layer-output").offset().top-$("#top-nav").height()-10&&!(a=$("#nav-svgs")).hasClass("disabled")?(a.siblings().removeClass("active"),a.addClass("active")):void 0})},{"gerber-to-svg":3}],2:[function(a,b){(function(){var a;a=function(){function a(a){this.file=a,this.index=0,this.line=1}return a.prototype.nextCommand=function(){var a,b,c,d,e;if(this.index>=this.file.length)return!1;for(a=[],c="",e=!1,d=!1;!d&&this.index!==this.file.length;){if(b=this.file[this.index],"%"===b){if(e?d=!0:e=!0,0!==c.length)throw new Error("% after "+c+" doesn't make sense");a.push("%")}else"*"===b?(a.push(c),c="",e||(d=!0)):b>=" "&&"~">=b?c+=b:"\n"===b&&this.line++;this.index++}return a},a}(),b.exports=a}).call(this)},{}],3:[function(a,b){(function(){var c,d,e;d=a("./obj-to-xml"),c=a("./plotter"),e=function(a){var b,e,f,g,h,i;f=new c(a);try{i=f.plot()}catch(j){throw b=j}return f.bbox.xMin>=f.bbox.xMax?(f.bbox.xMin=0,f.bbox.xMax=0,g=0):g=parseFloat((f.bbox.xMax-f.bbox.xMin).toPrecision(10)),f.bbox.yMin>=f.bbox.yMax?(f.bbox.yMin=0,f.bbox.yMax=0,e=0):e=parseFloat((f.bbox.yMax-f.bbox.yMin).toPrecision(10)),h={svg:{xmlns:"http://www.w3.org/2000/svg",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink",width:""+g+f.units,height:""+e+f.units,viewBox:""+f.bbox.xMin+" "+f.bbox.yMin+" "+g+" "+e,id:f.gerberId,_:[]}},f.defs.length&&h.svg._.push({defs:{_:f.defs}}),f.group.g._.length&&(f.group.g.transform="translate(0,"+(f.bbox.yMin+f.bbox.yMax)+") scale(1,-1)",h.svg._.push(f.group)),d(h,{pretty:!0})},b.exports=e}).call(this)},{"./obj-to-xml":6,"./plotter":8}],4:[function(a,b){(function(){var a,c,d,e,f,g;c=/[\+-\/x\(\)]/,a=/[\$\d\.]+/,d=new RegExp("("+c.source+")|("+a.source+")","g"),g=function(a){var b;return b=a.match(d)},e=function(b){return a.test(b)},f=function(a){var b,c,d,f,h,i,j;return j=g(a),c=0,i=function(){return j[c]},b=function(a){return a===i()?c++:void 0},h=function(){var a,c;if(c=i(),b(c),e(c))a={type:"n",val:c};else{if("("!==c)throw new SytaxError(""+c+" is unexpected in an arithmetic string");if(a=d(),")"!==i())throw new SytaxError("expected ')'");b(")")}return a},f=function(){var a,c,d;for(a=h(),d=i();"x"===d||"/"===d;)b(d),c=h(),a={type:d,left:a,right:c},d=i();return a},(d=function(){var a,c,d;for(a=f(),d=i();"+"===d||"-"===d;)b(d),c=f(),a={type:d,left:a,right:c},d=i();return a})()},b.exports={tokenize:g,isNumber:e,parse:f}}).call(this)},{}],5:[function(a,b){(function(){var c,d,e,f;e=a("./pad-shapes"),d=a("./macro-calc"),f=a("./unique-id"),c=function(){function a(a){this.modifiers={},this.name=a[0].slice(2),this.blocks=a.slice(1),this.shapes=[],this.masks=[],this.bbox=[null,null,null,null]}return a.prototype.run=function(a,b){var c,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;for(null==b&&(b=[]),e=l=0,p=b.length;p>l;e=++l)g=b[e],this.modifiers["$"+(e+1)]=g;for(t=this.blocks,m=0,q=t.length;q>m;m++)c=t[m],this.runBlock(c);for(i="tool-"+a+"-pad-"+f(),h=[],u=this.masks,n=0,r=u.length;r>n;n++)g=u[n],h.push(g);if(this.shapes.length>1){for(d={id:i,_:[]},v=this.shapes,o=0,s=v.length;s>o;o++)j=v[o],d._.push(j);h=[{g:d}]}else 1===this.shapes.length&&(k=Object.keys(this.shapes[0])[0],this.shapes[0][k].id=i,h.push(this.shapes[0]));return{pad:h,padId:i,bbox:this.bbox,trace:!1}},a.prototype.runBlock=function(a){var b,c,d,e,f,g,h,i;switch(a[0]){case"$":return e=null!=(i=a.match(/^\$\d+(?=\=)/))?i[0]:void 0,f=a.slice(1+e.length),this.modifiers[e]=this.getNumber(f);case"1":case"2":case"20":case"21":case"22":case"4":case"5":case"6":case"7":for(c=a.split(","),d=g=0,h=c.length;h>g;d=++g)b=c[d],c[d]=this.getNumber(b);return this.primitive(c);default:if("0"!==a[0])throw new SyntaxError("'"+a+"' unrecognized tool macro block")}},a.prototype.primitive=function(a){var b,c,d,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F;switch(h=!1,l=!1,n=null,a[0]){case 1:n=e.circle({dia:a[2],cx:a[3],cy:a[4]}),0===a[1]?h=!0:this.addBbox(n.bbox);break;case 2:case 20:n=e.vector({width:a[2],x1:a[3],y1:a[4],x2:a[5],y2:a[6]}),a[7]&&(n.shape.line.transform="rotate("+a[7]+")"),0===a[1]?h=!0:this.addBbox(n.bbox,a[7]);break;case 21:n=e.rect({cx:a[4],cy:a[5],width:a[2],height:a[3]}),a[6]&&(n.shape.rect.transform="rotate("+a[6]+")"),0===a[1]?h=!0:this.addBbox(n.bbox,a[6]);break;case 22:n=e.lowerLeftRect({x:a[4],y:a[5],width:a[2],height:a[3]}),a[6]&&(n.shape.rect.transform="rotate("+a[6]+")"),0===a[1]?h=!0:this.addBbox(n.bbox,a[6]);break;case 4:for(j=[],c=o=3,z=3+2*a[2];z>=o;c=o+=2)j.push([a[c],a[c+1]]);n=e.outline({points:j}),(k=a[a.length-1])&&(n.shape.polygon.transform="rotate("+k+")"),0===a[1]?h=!0:this.addBbox(n.bbox,a[a.length-1]);break;case 5:if(0!==a[6]&&(0!==a[3]||0!==a[4]))throw new RangeError("polygon center must be 0,0 if rotated in macro");n=e.polygon({cx:a[3],cy:a[4],dia:a[5],verticies:a[2],degrees:a[6]}),0===a[1]?h=!0:this.addBbox(n.bbox);break;case 6:if(0!==a[9]&&(0!==a[1]||0!==a[2]))throw new RangeError("moiré center must be 0,0 if rotated in macro");if(n=e.moire({cx:a[1],cy:a[2],outerDia:a[3],ringThx:a[4],ringGap:a[5],maxRings:a[6],crossThx:a[7],crossLength:a[8]}),a[9])for(A=n.shape,p=0,s=A.length;s>p;p++)m=A[p],null!=m.line&&(m.line.transform="rotate("+a[9]+")");this.addBbox(n.bbox,a[9]);break;case 7:if(0!==a[9]&&(0!==a[1]||0!==a[2]))throw new RangeError("thermal center must be 0,0 if rotated in macro");if(n=e.thermal({cx:a[1],cy:a[2],outerDia:a[3],innerDia:a[4],gap:a[5]}),a[6])for(B=n.shape,q=0,t=B.length;t>q;q++)if(m=B[q],null!=m.mask)for(C=m.mask._,r=0,u=C.length;u>r;r++)g=C[r],null!=g.rect&&(g.rect.transform="rotate("+a[6]+")");this.addBbox(n.bbox,a[6]);break;default:throw new SyntaxError(""+a[0]+" is not a valid primitive code")}if(h){for(d in n.shape)n.shape[d].fill="#000";if(i="macro-"+this.name+"-mask-"+f(),g={mask:{id:i,_:[{rect:{x:this.bbox[0],y:this.bbox[1],width:this.bbox[2]-this.bbox[0],height:this.bbox[3]-this.bbox[1],fill:"#fff"}},n.shape]}},1===this.shapes.length)for(d in this.shapes[0])this.shapes[0][d].mask="url(#"+i+")";else if(this.shapes.length>1){for(b={mask:"url(#"+i+")",_:[]},D=this.shapes,x=0,v=D.length;v>x;x++)m=D[x],b._.push(m);this.shapes=[{g:b}]}return this.masks.push(g)}if(Array.isArray(n.shape)){for(E=n.shape,F=[],y=0,w=E.length;w>y;y++)m=E[y],F.push(null!=m.mask?this.masks.push(m):this.shapes.push(m));return F}return this.shapes.push(n.shape)},a.prototype.addBbox=function(a,b){var c,d,e,f,g,h,i,j,k;if(null==b&&(b=0),b){for(f=Math.sin(b*Math.PI/180),c=Math.cos(b*Math.PI/180),Math.abs(f)<1e-9&&(f=0),Math.abs(c)<1e-9&&(c=0),e=[[a[0],a[1]],[a[2],a[1]],[a[2],a[3]],[a[0],a[3]]],k=[],i=0,j=e.length;j>i;i++)d=e[i],g=d[0]*c-d[1]*f,h=d[0]*f+d[1]*c,(null===this.bbox[0]||g<this.bbox[0])&&(this.bbox[0]=g),(null===this.bbox[1]||h<this.bbox[1])&&(this.bbox[1]=h),(null===this.bbox[2]||g>this.bbox[2])&&(this.bbox[2]=g),k.push(null===this.bbox[3]||h>this.bbox[3]?this.bbox[3]=h:void 0);return k}return(null===this.bbox[0]||a[0]<this.bbox[0])&&(this.bbox[0]=a[0]),(null===this.bbox[1]||a[1]<this.bbox[1])&&(this.bbox[1]=a[1]),(null===this.bbox[2]||a[2]>this.bbox[2])&&(this.bbox[2]=a[2]),null===this.bbox[3]||a[3]>this.bbox[3]?this.bbox[3]=a[3]:void 0},a.prototype.getNumber=function(a){return a.match(/^[+-]?[\d.]+$/)?parseFloat(a):a.match(/^\$\d+$/)?parseFloat(this.modifiers[a]):this.evaluate(d.parse(a))},a.prototype.evaluate=function(a){switch(a.type){case"n":return this.getNumber(a.val);case"+":return this.evaluate(a.left)+this.evaluate(a.right);case"-":return this.evaluate(a.left)-this.evaluate(a.right);case"x":return this.evaluate(a.left)*this.evaluate(a.right);case"/":return this.evaluate(a.left)/this.evaluate(a.right)}},a}(),b.exports=c}).call(this)},{"./macro-calc":4,"./pad-shapes":7,"./unique-id":10}],6:[function(a,b){(function(){var a,c,d,e;e=function(a,b){var c;if(c="",0===b)return"";for(;b>1;)1&b&&(c+=a),b>>=1,a+=a;return c+a},a="_",c="  ",d=function(b,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;if(null==f&&(f={}),n=f.pretty,j=null!=(t=f.indent)?t:0,l=n?"\n":"",o=l?"string"==typeof n?n:c:"",o=e(o,j),q="",Array.isArray(b))for(i=r=0,s=b.length;s>r;i=++r)m=b[i],q+=(0!==i?l:"")+d(m,f);else if(g=!1,h=Object.keys(b)[0],null!=h){q=""+o+"<"+h,u=b[h];for(k in u)p=u[k],k===a?g=p:q+=" "+k+'="'+p+'"';g&&(q+=">"+l+d(g,{pretty:n,indent:j+1})),q+=null!=b[h]._?""+l+o+"</"+h+">":"/>"}return q},b.exports=d}).call(this)},{}],7:[function(a,b){(function(){var c,d,e,f,g,h,i,j,k;j=a("./unique-id"),c=function(a){var b;if(null==a.dia)throw new SyntaxError("circle function requires diameter");if(null==a.cx)throw new SyntaxError("circle function requires x center");if(null==a.cy)throw new SyntaxError("circle function requires y center");return b=a.dia/2,{shape:{circle:{cx:a.cx,cy:a.cy,r:b,"stroke-width":0,fill:"currentColor"}},bbox:[a.cx-b,a.cy-b,a.cx+b,a.cy+b]}},h=function(a){var b,c,d,e;if(null==a.width)throw new SyntaxError("rectangle requires width");if(null==a.height)throw new SyntaxError("rectangle requires height");if(null==a.cx)throw new SyntaxError("rectangle function requires x center");if(null==a.cy)throw new SyntaxError("rectangle function requires y center");return d=a.cx-a.width/2,e=a.cy-a.height/2,c={shape:{rect:{x:d,y:e,width:a.width,height:a.height,"stroke-width":0,fill:"currentColor"}},bbox:[d,e,d+a.width,e+a.height]},a.obround&&(b=.5*Math.min(a.width,a.height),c.shape.rect.rx=b,c.shape.rect.ry=b),c},g=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;if(null==a.dia)throw new SyntaxError("polygon requires diameter");if(null==a.verticies)throw new SyntaxError("polygon requires verticies");if(null==a.cx)throw new SyntaxError("polygon function requires x center");if(null==a.cy)throw new SyntaxError("polygon function requires y center");for(g=null!=a.degrees?a.degrees*Math.PI/180:0,h=2*Math.PI/a.verticies,d=a.dia/2,c="",l=null,o=null,k=null,n=null,b=p=0,q=a.verticies;q>=0?q>p:p>q;b=q>=0?++p:--p)i=g+b*h,e=d*Math.cos(i),f=d*Math.sin(i),Math.abs(e)<1e-9&&(e=0),Math.abs(f)<1e-9&&(f=0),j=a.cx+e,m=a.cy+f,(l>j||null===l)&&(l=j),(j>k||null===k)&&(k=j),(o>m||null===o)&&(o=m),(m>n||null===n)&&(n=m),c+=" "+j+","+m;return{shape:{polygon:{points:c.slice(1),"stroke-width":0,fill:"currentColor"}},bbox:[l,o,k,n]}},k=function(a){var b,c,d;if(null==a.x1)throw new SyntaxError("vector function requires start x");if(null==a.y1)throw new SyntaxError("vector function requires start y");if(null==a.x2)throw new SyntaxError("vector function requires end x");if(null==a.y2)throw new SyntaxError("vector function requires end y");if(null==a.width)throw new SyntaxError("vector function requires width");return b=Math.abs(Math.atan((a.y2-a.y1)/(a.x2-a.x1))),c=a.width/2*Math.sin(b),d=a.width/2*Math.cos(b),1e-7>c&&(c=0),1e-7>d&&(d=0),{shape:{line:{x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2,"stroke-width":a.width,stroke:"currentColor"}},bbox:[Math.min(a.x1,a.x2)-c,Math.min(a.y1,a.y2)-d,Math.max(a.x1,a.x2)+c,Math.max(a.y1,a.y2)+d]}},d=function(a){if(null==a.width)throw new SyntaxError("lower left rect requires width");if(null==a.height)throw new SyntaxError("lower left rect requires height");if(null==a.x)throw new SyntaxError("lower left rectangle requires x");if(null==a.y)throw new SyntaxError("lower left rectangle requires y");return{shape:{rect:{x:a.x,y:a.y,width:a.width,height:a.height,"stroke-width":0,fill:"currentColor"}},bbox:[a.x,a.y,a.x+a.width,a.y+a.height]}},f=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(!(Array.isArray(a.points)&&a.points.length>1))throw new SyntaxError("outline function requires points array");for(g=null,k=null,f=null,j=null,c="",n=a.points,l=0,m=n.length;m>l;l++){if(b=n[l],!Array.isArray(b)||2!==b.length)throw new SyntaxError("outline function requires points array");d=b[0],h=b[1],(g>d||null===g)&&(g=d),(d>f||null===f)&&(f=d),(k>h||null===k)&&(k=h),(h>j||null===j)&&(j=h),c+=" "+d+","+h}if(e=a.points[a.points.length-1][0],i=a.points[a.points.length-1][1],e!==a.points[0][0]||i!==a.points[0][1])throw new RangeError("last point must match first point of outline");return{shape:{polygon:{points:c.slice(1),"stroke-width":0,fill:"currentColor"}},bbox:[g,k,f,j]}},e=function(a){var b,c,d;if(null==a.cx)throw new SyntaxError("moiré requires x center");if(null==a.cy)throw new SyntaxError("moiré requires y center");if(null==a.outerDia)throw new SyntaxError("moiré requires outer diameter");if(null==a.ringThx)throw new SyntaxError("moiré requires ring thickness");if(null==a.ringGap)throw new SyntaxError("moiré requires ring gap");if(null==a.maxRings)throw new SyntaxError("moiré requires max rings");if(null==a.crossLength)throw new SyntaxError("moiré requires crosshair length");if(null==a.crossThx)throw new SyntaxError("moiré requires crosshair thickness");for(d=[{line:{x1:a.cx-a.crossLength/2,y1:0,x2:a.cx+a.crossLength/2,y2:0,"stroke-width":a.crossThx,stroke:"currentColor"}},{line:{x1:0,y1:a.cy-a.crossLength/2,x2:0,y2:a.cy+a.crossLength/2,"stroke-width":a.crossThx,stroke:"currentColor"}}],b=(a.outerDia-a.ringThx)/2,c=0;b>=a.ringThx&&c<a.maxRings;)d.push({circle:{cx:a.cx,cy:a.cy,r:b,fill:"none","stroke-width":a.ringThx,stroke:"currentColor"}}),c++,b-=a.ringThx+a.ringGap;return b+=.5*a.ringThx,b>0&&c<a.maxRings&&d.push({circle:{cx:a.cx,cy:a.cy,r:b,"stroke-width":0,fill:"currentColor"}}),{shape:d,bbox:[Math.min(a.cx-a.crossLength/2,a.cx-a.outerDia/2),Math.min(a.cy-a.crossLength/2,a.cy-a.outerDia/2),Math.max(a.cx+a.crossLength/2,a.cx+a.outerDia/2),Math.max(a.cy+a.crossLength/2,a.cy+a.outerDia/2)]}},i=function(a){var b,c,d,e,f,g,h,i,k;if(null==a.cx)throw new SyntaxError("thermal requires x center");if(null==a.cy)throw new SyntaxError("thermal requires y center");if(null==a.outerDia)throw new SyntaxError("thermal requires outer diameter");if(null==a.innerDia)throw new SyntaxError("thermal requires inner diameter");if(null==a.gap)throw new SyntaxError("thermal requires gap");return c="thermal-mask-"+j(),f=(a.outerDia-a.innerDia)/2,d=a.outerDia/2,e=d-f/2,h=a.cx-d,g=a.cx+d,k=a.cy-d,i=a.cy+d,b=a.gap/2,{shape:[{mask:{id:c,_:[{circle:{cx:a.cx,cy:a.cy,r:d,"stroke-width":0,fill:"#fff"}},{rect:{x:h,y:-b,width:a.outerDia,height:a.gap,"stroke-width":0,fill:"#000"}},{rect:{x:-b,y:k,width:a.gap,height:a.outerDia,"stroke-width":0,fill:"#000"}}]}},{circle:{cx:a.cx,cy:a.cy,r:e,fill:"none","stroke-width":f,stroke:"currentColor",mask:"url(#"+c+")"}}],bbox:[h,k,g,i]}},b.exports={circle:c,rect:h,polygon:g,vector:k,lowerLeftRect:d,outline:f,moire:e,thermal:i}}).call(this)},{"./unique-id":10}],8:[function(a,b){(function(){var c,d,e,f,g,h;d=a("./gerber-parser"),h=a("./unique-id"),c=a("./macro-tool"),g=a("./standard-tool"),f=function(a){var b,c,d,e,f,h,i,j,k,l;if(d=null!=(j=a.match(/^ADD\d+/))&&null!=(k=j[0])?k.slice(2):void 0,!(null!=d&&parseInt(d.slice(1),10)>9))throw new SyntaxError(""+d+" is an invalid tool code (must be >= 10)");switch(b=null,c=!1,a.slice(2+d.length,4+d.length)){case"C,":f=a.slice(4+d.length).split("X"),i={dia:parseFloat(f[0])},f.length>2?i.hole={width:parseFloat(f[1]),height:parseFloat(f[2])}:f.length>1&&(i.hole={dia:parseFloat(f[1])}),b=g(d,i);break;case"R,":f=a.slice(4+d.length).split("X"),i={width:parseFloat(f[0]),height:parseFloat(f[1])},f.length>3?i.hole={width:parseFloat(f[2]),height:parseFloat(f[3])}:f.length>2&&(i.hole={dia:parseFloat(f[2])}),b=g(d,i);break;case"O,":f=a.slice(4+d.length).split("X"),i={width:parseFloat(f[0]),height:parseFloat(f[1])},f.length>3?i.hole={width:parseFloat(f[2]),height:parseFloat(f[3])}:f.length>2&&(i.hole={dia:parseFloat(f[2])}),i.obround=!0,b=g(d,i);break;case"P,":f=a.slice(4+d.length).split("X"),i={dia:parseFloat(f[0]),verticies:parseFloat(f[1])},null!=f[2]&&(i.degrees=parseFloat(f[2])),f.length>4?i.hole={width:parseFloat(f[3]),height:parseFloat(f[4])}:f.length>3&&(i.hole={dia:parseFloat(f[3])}),b=g(d,i);break;default:if(e=a.slice(2+d.length),h=null!=(l=e.match(/[a-zA-Z_$][a-zA-Z_$.0-9]{0,126}(?=,)?/))?l[0]:void 0,!h)throw new SyntaxError("invalid definition with macro");f=e.slice(h.length+1).split("X"),1===f.length&&""===f[0]&&(f=null),c={name:h,mods:f}}return{macro:c,tool:b,code:d}},e=function(){function a(a){null==a&&(a=""),this.parser=new d(a),this.macros={},this.tools={},this.currentTool="",this.defs=[],this.gerberId="gerber-"+h(),this.group={g:{id:""+this.gerberId+"-layer-0",_:[]}},this.layer={level:0,type:"g",current:this.group},this.stepRepeat={x:1,y:1,xStep:null,yStep:null,block:0},this.done=!1,this.units=null,this.format={set:!1,zero:null,notation:null,places:null},this.position={x:0,y:0},this.mode=null,this.trace={region:!1,path:""},this.quad=null,this.bbox={xMin:1/0,yMin:1/0,xMax:-1/0,yMax:-1/0}}return a.prototype.plot=function(){for(var a;!this.done;){if(a=this.parser.nextCommand(),a===!1)throw new Error("end of file encountered before required M02 command");"%"===a[0]?this.parameter(a):this.operate(a[0])}return this.finish()},a.prototype.finish=function(){return this.finishTrace(),this.finishStepRepeat()},a.prototype.parameter=function(a){var b,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;if(e=!1,"%"===a[0]&&"%"!==a[a.length-1])throw new SyntaxError("@parameter should only be called with paramters");for(a=a.slice(1),j=0,A=[];!e;){switch(d=a[j],d.slice(0,2)){case"FS":if(k=!1,this.format.set)throw new SyntaxError("format spec cannot be redefined");try{"L"===d[2]||"T"===d[2]?this.format.zero=d[2]:k=!0,"A"===d[3]||"I"===d[3]?this.format.notation=d[3]:k=!0,"X"===d[4]&&"Y"===d[7]&&d.slice(5,7)===d.slice(8,10)?(this.format.places=[parseInt(d[5],10),parseInt(d[6],10)],(this.format.places[0]>7||this.format.places[1]>7)&&(k=!0)):k=!0}catch(B){g=B,k=!0}if(k)throw new SyntaxError("invalid format spec");this.format.set=!0;break;case"MO":if(q=d.slice(2),null!=this.units)throw new SyntaxError("gerber file may not redifine units");if("MM"===q)this.units="mm";else{if("IN"!==q)throw new SyntaxError(""+q+" are unrecognized units");this.units="in"}break;case"AD":if(b=f(a[j]),null!=this.tools[b.code])throw new SyntaxError("duplicate tool code");b.macro&&(b.tool=this.macros[b.macro.name].run(b.code,b.macro.mods)),this.tools[b.code]={stroke:b.tool.trace,pad:function(){var a,c,d,e;for(d=b.tool.pad,e=[],a=0,c=d.length;c>a;a++)n=d[a],e.push(n);return e}(),flash:function(a,c){return{use:{x:a,y:c,"xlink:href":"#"+b.tool.padId}}},bbox:function(a,c){return null==a&&(a=0),null==c&&(c=0),{xMin:a+b.tool.bbox[0],yMin:c+b.tool.bbox[1],xMax:a+b.tool.bbox[2],yMax:c+b.tool.bbox[3]}}},this.currentTool=b.code;break;case"AM":l=new c(a.slice(0,-1)),this.macros[l.name]=l,e=!0;break;case"SR":this.finishTrace(),this.finishStepRepeat(),this.stepRepeat.x=Number(null!=(u=null!=(v=d.match(/X\d+/))?v[0].slice(1):void 0)?u:1),this.stepRepeat.y=Number(null!=(w=null!=(x=d.match(/Y\d+/))?x[0].slice(1):void 0)?w:1),this.stepRepeat.x>1&&(this.stepRepeat.xStep=Number(null!=(y=d.match(/I[\d\.]+/))?y[0].slice(1):void 0)),this.stepRepeat.y>1&&(this.stepRepeat.yStep=Number(null!=(z=d.match(/J[\d\.]+/))?z[0].slice(1):void 0)),(1!==this.stepRepeat.x||1!==this.stepRepeat.y)&&0===this.layer.level&&(p={g:{id:""+this.gerberId+"-sr-block-"+this.stepRepeat.block,_:[]}},this.layer.current[this.layer.type]._.push(p),this.layer.current=p);break;case"LP":if(this.finishTrace(),o=d[2],"D"!==o&&"C"!==o)throw new SyntaxError(""+d+" is an unrecognized level polarity");"D"===o&&"mask"===this.layer.type?(h=""+this.gerberId+"-layer-"+ ++this.layer.level,this.group={g:{id:h,_:[this.group]}},this.layer.current=this.group,this.layer.type="g"):"C"===o&&"g"===this.layer.type&&(m=""+this.gerberId+"-layer-"+ ++this.layer.level,s=this.bbox.xMin,t=this.bbox.yMin,r=this.bbox.xMax-this.bbox.xMin,i=this.bbox.yMax-this.bbox.yMin,l={mask:{id:m,color:"#000",_:[{rect:{x:s,y:t,width:r,height:i,fill:"#fff"}}]}},this.defs.push(l),this.layer.current.g.mask="url(#"+m+")",this.layer.current=this.defs[this.defs.length-1],this.layer.type="mask"),this.position.x=null,this.position.y=null}A.push("%"===a[++j]?e=!0:void 0)}return A},a.prototype.operate=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U;if(u=!1,d=a.slice(0,3),"M"===a[0]){if("M02"===d)this.done=!0,a="";else if("M00"!==d&&"M01"!==d)throw new SyntaxError("invalid operation M code");u=!0}else if("G"===a[0]){if(a.match(/^G0?1/))this.mode="i";else if(a.match(/^G0?2/))this.mode="cw";else if(a.match(/^G0?3(?![67])/))this.mode="ccw";else if("G36"===d)this.finishTrace(),this.trace.region=!0;else if("G37"===d)this.finishTrace(),this.trace.region=!1;else if("G74"===d)this.quad="s";else if("G75"===d)this.quad="m";else if("G70"===d)this.backupUnits="in";else if("G71"===d)this.backupUnits="mm";else if(!d.match(/^G(0?4)|(5[45])|(7[01])|(9[01])/))throw new SyntaxError("invalid operation G code");u=!0}if(q=null!=(H=a.match(/D[1-9]\d{1,}$/))?H[0]:void 0,null!=q){if(this.finishTrace(),null==this.tools[q])throw new SyntaxError("tool "+q+" does not exist");if(this.trace.region)throw new SyntaxError("cannot change tool while region mode is on");this.currentTool=q}if(a.match(/^(G0?[123])?([XYIJ][+-]?\d+){0,4}D0?[123]$/)){if(l=a[a.length-1],e=null!=(I=null!=(N=a.match(/[XYIJ][+-]?\d+/g))?N.join(""):void 0)?I:"",o={x:this.position.x,y:this.position.y},i=this.move(e),"3"===l){if(this.finishTrace(),this.tools[this.currentTool].pad){for(O=this.tools[this.currentTool].pad,z=0,D=O.length;D>z;z++)k=O[z],this.defs.push(k);this.tools[this.currentTool].pad=!1}return this.layer.current[this.layer.type]._.push(this.tools[this.currentTool].flash(this.position.x,this.position.y)),this.addBbox(this.tools[this.currentTool].bbox(this.position.x,this.position.y))}if("1"===l){if(this.trace.path||(this.trace.path="M"+o.x+" "+o.y,"i"===this.mode&&this.addBbox(this.trace.region?{xMin:o.x,yMin:o.y,xMax:o.x,yMax:o.y}:this.tools[this.currentTool].bbox(o.x,o.y))),null==this.mode&&(this.mode="i"),"i"===this.mode)return this.trace.path+="L"+i.x+" "+i.y,this.addBbox(this.trace.region?{xMin:i.x,yMin:i.y,xMax:i.x,yMax:i.y}:this.tools[this.currentTool].bbox(i.x,i.y));if("cw"===this.mode||"ccw"===this.mode){if(m=Math.sqrt(Math.pow(i.i,2)+Math.pow(i.j,2)),p="cw"===this.mode?0:1,j=0,c=[],s=0,t=0,"s"===this.quad)for(P=[o.x-i.i,o.x+i.i],A=0,E=P.length;E>A;A++)for(f=P[A],Q=[o.y-i.j,o.y+i.j],B=0,F=Q.length;F>B;B++)g=Q[B],h=Math.sqrt(Math.pow(f-i.x,2)+Math.pow(g-i.y,2)),Math.abs(m-h)<1e-7&&c.push({x:f,y:g});else"m"===this.quad&&c.push({x:o.x+i.i,y:o.y+i.j});for(C=0,G=c.length;G>C;C++)if(b=c[C],s=Math.atan2(i.y-b.y,i.x-b.x),0>s&&(s+=2*Math.PI),t=Math.atan2(o.y-b.y,o.x-b.x),0>t&&(t+=2*Math.PI),"cw"===this.mode&&s>t?t+=2*Math.PI:"ccw"===this.mode&&t>s&&(s+=2*Math.PI),r=Math.abs(s-t),!("s"===this.quad&&Math.abs(s-t)>Math.PI/2)){"m"===this.quad&&r>=Math.PI&&(j=1),c={x:b.x,y:b.y};break}return n=this.trace.region?0:this.tools[this.currentTool].bbox().xMax,w=t<=(R=Math.PI)&&s>=R||t>=(S=Math.PI)&&S>=s?c.x-m-n:Math.min(o.x,i.x)-n,v=t<=(T=2*Math.PI)&&s>=T||t>=(U=2*Math.PI)&&U>=s||0>=t&&s>=0||t>=0&&0>=s?c.x+m+n:Math.max(o.x,i.x)+n,y=t<=(J=3*Math.PI/2)&&s>=J||t>=(K=3*Math.PI/2)&&K>=s?c.y-m-n:Math.min(o.y,i.y)-n,x=t<=(L=Math.PI/2)&&s>=L||t>=(M=Math.PI/2)&&M>=s?c.y+m+n:Math.max(o.y,i.y)+n,"m"===this.quad&&Math.abs(o.x-i.x)<1e-6&&Math.abs(o.y-i.y)<1e-6&&(this.trace.path+="A"+m+" "+m+" 0 0 "+p+" "+(i.x+2*i.i)+" "+(i.y+2*i.j),w=c.x-m-n,y=c.y-m-n,v=c.x+m+n,x=c.y+m+n),this.trace.path+="A"+m+" "+m+" 0 "+j+" "+p+" "+i.x+" "+i.y,this.addBbox({xMin:w,yMin:y,xMax:v,yMax:x})}throw new SyntaxError("cannot interpolate without a G01/2/3")}if("2"===l)return this.finishTrace();throw new SyntaxError(""+l+" is an invalid operation (D) code")}},a.prototype.finishStepRepeat=function(){var a,b,c,d,e,f;if(1!==this.stepRepeat.x||1!==this.stepRepeat.y){if(0!==this.layer.level)throw new Error("step repeat with clear levels is unimplimented");for(a=this.layer.current.g.id,this.layer.current=this.group,f=[],b=d=0,e=this.stepRepeat.x;e>=0?e>d:d>e;b=e>=0?++d:--d)f.push(function(){var d,e,f;for(f=[],c=d=0,e=this.stepRepeat.y;e>=0?e>d:d>e;c=e>=0?++d:--d)f.push(0!==b||0!==c?this.layer.current[this.layer.type]._.push({use:{x:b*this.stepRepeat.xStep,y:c*this.stepRepeat.yStep,"xlink:href":a}}):void 0);return f}.call(this));return f}},a.prototype.finishTrace=function(){var a,b,c,d;if(this.trace.path){if(b={path:{d:this.trace.path}},this.trace.region)b.path["stroke-width"]=0,b.path.fill="currentColor";else{d=this.tools[this.currentTool].stroke;for(a in d)c=d[a],b.path[a]=c}return this.layer.current[this.layer.type]._.push(b),this.trace.path=""}},a.prototype.move=function(a){var b;if(null==this.units){if(null==this.backupUnits)throw new Error("units have not been set");this.units=this.backupUnits}return b=this.coordinate(a),this.position.x=b.x,this.position.y=b.y,b},a.prototype.coordinate=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(!this.format.set)throw new SyntaxError("format undefined");d={x:0,y:0},d.x=null!=(f=a.match(/X[+-]?\d+/))&&null!=(g=f[0])?g.slice(1):void 0,d.y=null!=(h=a.match(/Y[+-]?\d+/))&&null!=(i=h[0])?i.slice(1):void 0,d.i=null!=(j=a.match(/I[+-]?\d+/))&&null!=(k=j[0])?k.slice(1):void 0,d.j=null!=(l=a.match(/J[+-]?\d+/))&&null!=(m=l[0])?m.slice(1):void 0;for(c in d)if(e=d[c],null!=e){if(b=1,("+"===e[0]||"-"===e[0])&&("-"===e[0]&&(b=-1),e=e.slice(1)),"L"===this.format.zero)b*=Math.pow(10,this.format.places[1]);else{if("T"!==this.format.zero)throw new SyntaxError("invalid zero suppression format");b*=Math.pow(10,e.length-this.format.places[0])}d[c]=Number(e)/b,"I"===this.format.notation&&(d[c]+=null!=(n=this.position[c])?n:0)}return null==d.x&&(d.x=this.position.x),null==d.y&&(d.y=this.position.y),null==d.i&&(d.i=0),null==d.j&&(d.j=0),d},a.prototype.addBbox=function(a){return a.xMin<this.bbox.xMin&&(this.bbox.xMin=a.xMin),a.yMin<this.bbox.yMin&&(this.bbox.yMin=a.yMin),a.xMax>this.bbox.xMax&&(this.bbox.xMax=a.xMax),a.yMax>this.bbox.yMax?this.bbox.yMax=a.yMax:void 0},a}(),b.exports=e}).call(this)},{"./gerber-parser":2,"./macro-tool":5,"./standard-tool":9,"./unique-id":10}],9:[function(a,b){(function(){var c,d,e;e=a("./unique-id"),c=a("./pad-shapes"),d=function(a,b){var d,f,g,h,i,j,k;if(j={pad:[],trace:!1},b.cx=0,b.cy=0,f="tool-"+a+"-pad-"+e(),k="",null!=b.dia&&null==b.verticies){if(null!=b.obround||null!=b.width||null!=b.height||null!=b.degrees)throw new Error("incompatible parameters for tool "+a);if(b.dia<0)throw new RangeError(""+a+" circle diameter out of range ("+b.dia+"<0)");k="circle",null==b.hole&&(j.trace={"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":b.dia,stroke:"currentColor",fill:"none"})}else if(null!=b.width&&null!=b.height){if(null!=b.dia||null!=b.verticies||null!=b.degrees)throw new Error("incompatible parameters for tool "+a);if(b.width<=0)throw new RangeError(""+a+" rect width out of range ("+b.width+"<=0)");if(b.height<=0)throw new RangeError(""+a+" rect height out of range ("+b.height+"<=0)");k="rect",null!=b.hole||b.obround||(j.trace={"stroke-width":0})}else{if(null==b.dia||null==b.verticies)throw new Error("unidentified standard tool shape");if(null!=b.obround||null!=b.width||null!=b.height)throw new Error("incompatible parameters for tool "+a);if(b.verticies<3||b.verticies>12)throw new RangeError(""+a+" polygon points out of range ("+b.verticies+"<3 or >12)]");k="polygon"}if(i=c[k](b),null!=b.hole){if(d=null,null!=b.hole.dia&&null==b.hole.width&&null==b.hole.height){if(!(b.hole.dia>=0))throw new RangeError(""+a+" hole diameter out of range ("+b.hole.dia+"<0)");
d=c.circle({cx:b.cx,cy:b.cy,dia:b.hole.dia}),d=d.shape,d.circle.fill="#000"}else{if(null==b.hole.width||null==b.hole.height)throw new Error(""+a+" has invalid hole parameters");if(!(b.hole.width>=0))throw new RangeError(""+a+" hole width out of range ("+b.hole.width+"<0)");if(!(b.hole.height>=0))throw new RangeError(""+a+" hole height out of range");d=c.rect({cx:b.cx,cy:b.cy,width:b.hole.width,height:b.hole.height}),d=d.shape,d.rect.fill="#000"}h=f+"-mask",g={mask:{id:f+"-mask",_:[{rect:{x:i.bbox[0],y:i.bbox[1],width:i.bbox[2]-i.bbox[0],height:i.bbox[3]-i.bbox[1],fill:"#fff"}},d]}},i.shape[k].mask="url(#"+h+")",j.pad.push(g)}return f&&(i.shape[k].id=f),j.pad.push(i.shape),j.bbox=i.bbox,j.padId=f,j},b.exports=d}).call(this)},{"./pad-shapes":7,"./unique-id":10}],10:[function(a,b){(function(){var a,c;c=1e3,a=function(){return c++},b.exports=a}).call(this)},{}]},{},[1]);